println "config phase"
println "gradle id: ${gradle.hashCode()}"
println "root: ${rootProject.toString()}"

task hello(description: "Hello task v2", group: "dshidlovskiy") {
    println "configuration phase. Task hello"
    println "task: $description, group: $group, action: ${actions.size()}"

    doLast {
        println "Action1"
    }
    doFirst {
        println "Action2"
    }
}
//gradle.taskGraph.allTasks возвращает упорядоченный граф тасков в зависимости от установленных связей
task first{
    doLast {
        println "Task1"
    }
}
task second{
    doLast {
        println "Task2"
    }
}
task third{
    doLast {
        println "Task3"
    }
}
task fourth(group: "dshid"){
    doLast {
        println "Task4"
    }
}
// 2<---4
fourth.dependsOn second
second.dependsOn first
second.finalizedBy third
gradle.taskGraph.whenReady {TaskExecutionGraph graph ->
    println "-------Graph:"
    graph.allTasks.each {
        println "${it.name}"
    }
}
gradle.taskGraph.beforeTask {Task task ->
    if (task.group == "dshid")
        println "beforeTask callBack $task"
}

defaultTasks "fourth"